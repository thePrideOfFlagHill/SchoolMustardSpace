{"remainingRequest":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\src\\layout\\header-aside\\components\\panel-search\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\src\\layout\\header-aside\\components\\panel-search\\index.vue","mtime":1590487885000},{"path":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\58215\\Desktop\\SchoolMustardSpace\\Html (front for user)\\schoolSpace\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBGdXNlIGZyb20gJ2Z1c2UuanMnCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IG1peGluIGZyb20gJy4uL21peGluL21lbnUnCmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFsKICAgIG1peGluCiAgXSwKICBjb21wb25lbnRzOiB7CiAgICAnZDItcGFuZWwtc2VhcmNoLWl0ZW0nOiAoKSA9PiBpbXBvcnQoJy4vY29tcG9uZW50cy9wYW5lbC1zZWFyY2gtaXRlbS9pbmRleC52dWUnKQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBzZWFyY2hUZXh0OiAnJywKICAgICAgcmVzdWx0czogW10KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnZDJhZG1pbi9zZWFyY2gnLCBbCiAgICAgICdob3RrZXknLAogICAgICAncG9vbCcKICAgIF0pLAogICAgLy8g6L+Z5Lu95pWw5o2u5piv5bGV56S65Zyo5pCc57Si6Z2i5p2/5LiL6Z2i55qECiAgICByZXN1bHRzTGlzdCAoKSB7CiAgICAgIHJldHVybiAodGhpcy5yZXN1bHRzLmxlbmd0aCA9PT0gMCAmJiB0aGlzLnNlYXJjaFRleHQgPT09ICcnKSA/IHRoaXMucG9vbC5tYXAoZSA9PiAoewogICAgICAgIHZhbHVlOiBlLmZ1bGxUaXRsZSwKICAgICAgICAuLi5lCiAgICAgIH0pKSA6IHRoaXMucmVzdWx0cwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g6L+H5ruk6YCJ6aG5IOi/meS4quaWueazleWcqOavj+asoei+k+WFpeahhueahOWAvOWPkeeUn+WPmOWMluaXtuS8muinpuWPkQogICAgICovCiAgICBxdWVyeVNlYXJjaCAocXVlcnlTdHJpbmcsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBwb29sID0gdGhpcy5wb29sCiAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLnF1ZXJ5KHF1ZXJ5U3RyaW5nID8gcG9vbCA6IFtdLCBxdWVyeVN0cmluZykKICAgICAgdGhpcy5yZXN1bHRzID0gcmVzdWx0cwogICAgICBjYWxsYmFjayhyZXN1bHRzKQogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOaMh+WumueahOaVsOaNrua6kOS4reagueaNruaMh+WumueahOafpeivouWtl+espuS4sui/h+a7pOaVsOaNrgogICAgICogQHBhcmFtIHtPYmplY3R9IHBvb2wg6ZyA6KaB6L+H5ruk55qE5pWw5o2uCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcXVlcnlTdHJpbmcg5p+l6K+i5a2X56ym5LiyCiAgICAgKi8KICAgIHF1ZXJ5IChwb29sLCBxdWVyeVN0cmluZykgewogICAgICByZXR1cm4gbmV3IEZ1c2UocG9vbCwgewogICAgICAgIHNob3VsZFNvcnQ6IHRydWUsCiAgICAgICAgdG9rZW5pemU6IHRydWUsCiAgICAgICAgdGhyZXNob2xkOiAwLjYsCiAgICAgICAgbG9jYXRpb246IDAsCiAgICAgICAgZGlzdGFuY2U6IDEwMCwKICAgICAgICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMiwKICAgICAgICBtaW5NYXRjaENoYXJMZW5ndGg6IDEsCiAgICAgICAga2V5czogWwogICAgICAgICAgJ2Z1bGxUaXRsZScsCiAgICAgICAgICAncGF0aCcKICAgICAgICBdCiAgICAgIH0pCiAgICAgICAgLnNlYXJjaChxdWVyeVN0cmluZykKICAgICAgICAubWFwKGUgPT4gKHsKICAgICAgICAgIHZhbHVlOiBlLmZ1bGxUaXRsZSwKICAgICAgICAgIC4uLmUKICAgICAgICB9KSkKICAgIH0sCiAgICAvKioKICAgICAqIEBkZXNjcmlwdGlvbiDogZrnhKbovpPlhaXmoYYKICAgICAqLwogICAgZm9jdXMgKCkgewogICAgICB0aGlzLmlucHV0ID0gJycKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMuJHJlZnMuaW5wdXQpIHsKICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuZm9jdXMoKQogICAgICAgIH0KICAgICAgICAvLyDov5jljp8KICAgICAgICB0aGlzLnNlYXJjaFRleHQgPSAnJwogICAgICAgIHRoaXMucmVzdWx0cyA9IFtdCiAgICAgIH0sIDUwMCkKICAgIH0sCiAgICAvKioKICAgICAqIEBkZXNjcmlwdGlvbiDmjqXmlLbnlKjmiLflnKjliJfooajkuK3pgInmi6npobnnm67nmoTkuovku7YKICAgICAqLwogICAgaGFuZGxlUmVzdWx0c0dyb3VwSXRlbUNsaWNrIChwYXRoKSB7CiAgICAgIC8vIOWmguaenOeUqOaIt+mAieaLqeeahOWwseaYr+W9k+WJjemhtemdoiDlsLHnm7TmjqXlhbPpl63mkJzntKLpnaLmnb8KICAgICAgaWYgKHBhdGggPT09IHRoaXMuJHJvdXRlLnBhdGgpIHsKICAgICAgICB0aGlzLmhhbmRsZUVzYygpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgLy8g55So5oi36YCJ5oup55qE5piv5YW25a6D6aG16Z2iCiAgICAgIHRoaXMuaGFuZGxlTWVudVNlbGVjdChwYXRoKQogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOaOpeaUtueUqOaIt+WcqOS4i+aLieiPnOWNleS4remAieS4reS6i+S7tgogICAgICovCiAgICBhc3luYyBoYW5kbGVTZWxlY3QgKHsgcGF0aCB9KSB7CiAgICAgIC8vIOWmguaenOeUqOaIt+mAieaLqeeahOWwseaYr+W9k+WJjemhtemdoiDlsLHnm7TmjqXlhbPpl63mkJzntKLpnaLmnb8KICAgICAgaWYgKHBhdGggPT09IHRoaXMuJHJvdXRlLnBhdGgpIHsKICAgICAgICB0aGlzLmhhbmRsZUVzYygpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgLy8g55So5oi36YCJ5oup55qE5piv5YW25a6D6aG16Z2iCiAgICAgIGF3YWl0IHRoaXMuJG5leHRUaWNrKCkKICAgICAgdGhpcy5oYW5kbGVNZW51U2VsZWN0KHBhdGgpCiAgICB9LAogICAgLyoqCiAgICAgKiBAYXVnbWVudHMg5YWz6Zet6L6T5YWl5qGG55qE5LiL5ouJ6I+c5Y2VCiAgICAgKi8KICAgIGNsb3NlU3VnZ2VzdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmlucHV0LmFjdGl2YXRlZCkgewogICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuc3VnZ2VzdGlvbnMgPSBbXQogICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuYWN0aXZhdGVkID0gZmFsc2UKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICogQGF1Z21lbnRzIOaOpeaUtueUqOaIt+eCueWHu+epuueZveWMuuWfn+eahOWFs+mXrQogICAgICovCiAgICBoYW5kbGVQYW5lbENsaWNrICgpIHsKICAgICAgdGhpcy5oYW5kbGVFc2MoKQogICAgfSwKICAgIC8qKgogICAgICogQGF1Z21lbnRzIOaOpeaUtueUqOaIt+inpuWPkeeahOWFs+mXrQogICAgICovCiAgICBhc3luYyBoYW5kbGVFc2MgKCkgewogICAgICB0aGlzLmNsb3NlU3VnZ2VzdGlvbigpCiAgICAgIGF3YWl0IHRoaXMuJG5leHRUaWNrKCkKICAgICAgdGhpcy4kZW1pdCgnY2xvc2UnKQogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/layout/header-aside/components/panel-search","sourcesContent":["<template>\n  <div class=\"panel-search\" flex=\"dir:top\">\n    <div class=\"panel-search__input-group\" flex-box=\"0\" flex=\"dir:top main:center cross:center\" @click.self=\"handlePanelClick\">\n      <d2-icon-svg class=\"panel-search__logo\" name=\"d2-admin-text\"/>\n      <el-autocomplete\n        class=\"panel-search__input\"\n        ref=\"input\"\n        v-model=\"searchText\"\n        suffix-icon=\"el-icon-search\"\n        placeholder=\"搜索页面\"\n        :fetch-suggestions=\"querySearch\"\n        :trigger-on-focus=\"false\"\n        :clearable=\"true\"\n        @keydown.esc.native=\"handleEsc\"\n        @select=\"handleSelect\">\n        <d2-panel-search-item slot-scope=\"{ item }\" :item=\"item\"/>\n      </el-autocomplete>\n      <div class=\"panel-search__tip\">\n        您可以使用快捷键\n        <span class=\"panel-search__key\">{{hotkey.open}}</span>\n        唤醒搜索面板，按\n        <span class=\"panel-search__key\">{{hotkey.close}}</span>\n        关闭\n      </div>\n    </div>\n    <div v-if=\"resultsList.length > 0\" class=\"panel-search__results-group\" flex-box=\"1\">\n      <el-card shadow=\"never\">\n        <div class=\"panel-search__results-group-inner\">\n          <d2-panel-search-item\n            v-for=\"(item, index) in resultsList\"\n            :key=\"index\"\n            :item=\"item\"\n            :hover-mode=\"true\"\n            @click.native=\"handleResultsGroupItemClick(item.path)\"/>\n        </div>\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Fuse from 'fuse.js'\nimport { mapState } from 'vuex'\nimport mixin from '../mixin/menu'\nexport default {\n  mixins: [\n    mixin\n  ],\n  components: {\n    'd2-panel-search-item': () => import('./components/panel-search-item/index.vue')\n  },\n  data () {\n    return {\n      searchText: '',\n      results: []\n    }\n  },\n  computed: {\n    ...mapState('d2admin/search', [\n      'hotkey',\n      'pool'\n    ]),\n    // 这份数据是展示在搜索面板下面的\n    resultsList () {\n      return (this.results.length === 0 && this.searchText === '') ? this.pool.map(e => ({\n        value: e.fullTitle,\n        ...e\n      })) : this.results\n    }\n  },\n  methods: {\n    /**\n     * @description 过滤选项 这个方法在每次输入框的值发生变化时会触发\n     */\n    querySearch (queryString, callback) {\n      var pool = this.pool\n      const results = this.query(queryString ? pool : [], queryString)\n      this.results = results\n      callback(results)\n    },\n    /**\n     * @description 指定的数据源中根据指定的查询字符串过滤数据\n     * @param {Object} pool 需要过滤的数据\n     * @param {String} queryString 查询字符串\n     */\n    query (pool, queryString) {\n      return new Fuse(pool, {\n        shouldSort: true,\n        tokenize: true,\n        threshold: 0.6,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: [\n          'fullTitle',\n          'path'\n        ]\n      })\n        .search(queryString)\n        .map(e => ({\n          value: e.fullTitle,\n          ...e\n        }))\n    },\n    /**\n     * @description 聚焦输入框\n     */\n    focus () {\n      this.input = ''\n      setTimeout(() => {\n        if (this.$refs.input) {\n          this.$refs.input.focus()\n        }\n        // 还原\n        this.searchText = ''\n        this.results = []\n      }, 500)\n    },\n    /**\n     * @description 接收用户在列表中选择项目的事件\n     */\n    handleResultsGroupItemClick (path) {\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc()\n        return\n      }\n      // 用户选择的是其它页面\n      this.handleMenuSelect(path)\n    },\n    /**\n     * @description 接收用户在下拉菜单中选中事件\n     */\n    async handleSelect ({ path }) {\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc()\n        return\n      }\n      // 用户选择的是其它页面\n      await this.$nextTick()\n      this.handleMenuSelect(path)\n    },\n    /**\n     * @augments 关闭输入框的下拉菜单\n     */\n    closeSuggestion () {\n      if (this.$refs.input.activated) {\n        this.$refs.input.suggestions = []\n        this.$refs.input.activated = false\n      }\n    },\n    /**\n     * @augments 接收用户点击空白区域的关闭\n     */\n    handlePanelClick () {\n      this.handleEsc()\n    },\n    /**\n     * @augments 接收用户触发的关闭\n     */\n    async handleEsc () {\n      this.closeSuggestion()\n      await this.$nextTick()\n      this.$emit('close')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.panel-search {\n  margin: 20px;\n  width: 100%;\n  .panel-search__input-group {\n    height: 240px;\n    .panel-search__logo {\n      width: 80px;\n      height: 80px;\n      margin-bottom: 20px;\n    }\n    .panel-search__input {\n      width: 500px;\n    }\n    .panel-search__tip {\n      @extend %unable-select;\n      margin-top: 20px;\n      margin-bottom: 40px;\n      font-size: 12px;\n      color: $color-text-sub;\n      .panel-search__key {\n        padding: 1px 5px;\n        margin: 0px 2px;\n        border-radius: 2px;\n        background-color: $color-text-normal;\n        color: $color-bg;\n      }\n    }\n  }\n  .panel-search__results-group {\n    overflow: auto;\n    margin-bottom: -20px;\n    .panel-search__results-group-inner {\n      margin: -20px;\n    }\n  }\n}\n</style>\n"]}]}