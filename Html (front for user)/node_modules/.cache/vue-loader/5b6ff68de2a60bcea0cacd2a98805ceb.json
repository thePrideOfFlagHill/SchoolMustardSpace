{"remainingRequest":"D:\\实践\\d2-admin-start-kit-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\实践\\d2-admin-start-kit-master\\src\\layout\\header-aside\\components\\tabs\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\实践\\d2-admin-start-kit-master\\src\\layout\\header-aside\\components\\tabs\\index.vue","mtime":1587908413000},{"path":"D:\\实践\\d2-admin-start-kit-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\实践\\d2-admin-start-kit-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\实践\\d2-admin-start-kit-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\实践\\d2-admin-start-kit-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcKaW1wb3J0IFNvcnRhYmxlIGZyb20gJ3NvcnRhYmxlanMnCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRDJDb250ZXh0bWVudTogKCkgPT4gaW1wb3J0KCcuLi9jb250ZXh0bWVudScpLAogICAgRDJDb250ZXh0bWVudUxpc3Q6ICgpID0+IGltcG9ydCgnLi4vY29udGV4dG1lbnUvY29tcG9uZW50cy9jb250ZW50bWVudUxpc3QnKQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjb250ZXh0bWVudUZsYWc6IGZhbHNlLAogICAgICBjb250ZW50bWVudVg6IDAsCiAgICAgIGNvbnRlbnRtZW51WTogMCwKICAgICAgY29udGV4dG1lbnVMaXN0SW5kZXg6IFsKICAgICAgICB7IGljb246ICd0aW1lcy1jaXJjbGUnLCB0aXRsZTogJ+WFs+mXreWFqOmDqCcsIHZhbHVlOiAnYWxsJyB9CiAgICAgIF0sCiAgICAgIGNvbnRleHRtZW51TGlzdDogWwogICAgICAgIHsgaWNvbjogJ2Fycm93LWxlZnQnLCB0aXRsZTogJ+WFs+mXreW3puS+pycsIHZhbHVlOiAnbGVmdCcgfSwKICAgICAgICB7IGljb246ICdhcnJvdy1yaWdodCcsIHRpdGxlOiAn5YWz6Zet5Y+z5L6nJywgdmFsdWU6ICdyaWdodCcgfSwKICAgICAgICB7IGljb246ICd0aW1lcycsIHRpdGxlOiAn5YWz6Zet5YW25a6DJywgdmFsdWU6ICdvdGhlcicgfSwKICAgICAgICB7IGljb246ICd0aW1lcy1jaXJjbGUnLCB0aXRsZTogJ+WFs+mXreWFqOmDqCcsIHZhbHVlOiAnYWxsJyB9CiAgICAgIF0sCiAgICAgIHRhZ05hbWU6ICcvaW5kZXgnCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoJ2QyYWRtaW4vcGFnZScsIFsKICAgICAgJ29wZW5lZCcsCiAgICAgICdjdXJyZW50JwogICAgXSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoJ2QyYWRtaW4vcGFnZScsIFsKICAgICAgJ2Nsb3NlJywKICAgICAgJ2Nsb3NlTGVmdCcsCiAgICAgICdjbG9zZVJpZ2h0JywKICAgICAgJ2Nsb3NlT3RoZXInLAogICAgICAnY2xvc2VBbGwnLAogICAgICAnb3BlbmVkU29ydCcKICAgIF0pLAogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g6K6h566X5p+Q5Liq5qCH562+6aG15piv5ZCm5Y+v5YWz6ZetCiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFnZSDlhbbkuK3kuIDkuKrmoIfnrb7pobUKICAgICAqLwogICAgaXNUYWJDbG9zYWJsZSAocGFnZSkgewogICAgICByZXR1cm4gcGFnZS5uYW1lICE9PSAnaW5kZXgnCiAgICB9LAogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g5Y+z6ZSu6I+c5Y2V5Yqf6IO954K55Ye7CiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnQg5LqL5Lu2CiAgICAgKi8KICAgIGhhbmRsZUNvbnRleHRtZW51IChldmVudCkgewogICAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CiAgICAgIC8vIGZpeCBodHRwczovL2dpdGh1Yi5jb20vZDItcHJvamVjdHMvZDItYWRtaW4vaXNzdWVzLzU0CiAgICAgIGxldCBmbGFnID0gZmFsc2UKICAgICAgaWYgKHRhcmdldC5jbGFzc05hbWUuaW5kZXhPZignZWwtdGFic19faXRlbScpID4gLTEpIGZsYWcgPSB0cnVlCiAgICAgIGVsc2UgaWYgKHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTmFtZS5pbmRleE9mKCdlbC10YWJzX19pdGVtJykgPiAtMSkgewogICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlCiAgICAgICAgZmxhZyA9IHRydWUKICAgICAgfQogICAgICBpZiAoZmxhZykgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCkKICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKQogICAgICAgIHRoaXMuY29udGVudG1lbnVYID0gZXZlbnQuY2xpZW50WAogICAgICAgIHRoaXMuY29udGVudG1lbnVZID0gZXZlbnQuY2xpZW50WQogICAgICAgIHRoaXMudGFnTmFtZSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKS5zbGljZSg1KQogICAgICAgIHRoaXMuY29udGV4dG1lbnVGbGFnID0gdHJ1ZQogICAgICB9CiAgICB9LAogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g5Y+z6ZSu6I+c5Y2V55qEIHJvdy1jbGljayDkuovku7YKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb21tYW5kIOS6i+S7tuexu+WeiwogICAgICovCiAgICBjb250ZXh0bWVudUNsaWNrIChjb21tYW5kKSB7CiAgICAgIHRoaXMuaGFuZGxlQ29udHJvbEl0ZW1DbGljayhjb21tYW5kLCB0aGlzLnRhZ05hbWUpCiAgICB9LAogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g5o6l5pS254K55Ye75YWz6Zet5o6n5Yi25LiK6YCJ6aG555qE5LqL5Lu2CiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29tbWFuZCDkuovku7bnsbvlnosKICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0YWdOYW1lIHRhYiDlkI3np7AKICAgICAqLwogICAgaGFuZGxlQ29udHJvbEl0ZW1DbGljayAoY29tbWFuZCwgdGFnTmFtZSA9IG51bGwpIHsKICAgICAgaWYgKHRhZ05hbWUpIHRoaXMuY29udGV4dG1lbnVGbGFnID0gZmFsc2UKICAgICAgY29uc3QgcGFyYW1zID0geyBwYWdlU2VsZWN0OiB0YWdOYW1lIH0KICAgICAgc3dpdGNoIChjb21tYW5kKSB7CiAgICAgICAgY2FzZSAnbGVmdCc6IHRoaXMuY2xvc2VMZWZ0KHBhcmFtcyk7IGJyZWFrCiAgICAgICAgY2FzZSAncmlnaHQnOiB0aGlzLmNsb3NlUmlnaHQocGFyYW1zKTsgYnJlYWsKICAgICAgICBjYXNlICdvdGhlcic6IHRoaXMuY2xvc2VPdGhlcihwYXJhbXMpOyBicmVhawogICAgICAgIGNhc2UgJ2FsbCc6IHRoaXMuY2xvc2VBbGwoKTsgYnJlYWsKICAgICAgICBkZWZhdWx0OiB0aGlzLiRtZXNzYWdlLmVycm9yKCfml6DmlYjnmoTmk43kvZwnKTsgYnJlYWsKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOaOpeaUtueCueWHuyB0YWIg5qCH562+55qE5LqL5Lu2CiAgICAgKiBAcGFyYW0ge29iamVjdH0gdGFiIOagh+etvgogICAgICogQHBhcmFtIHtvYmplY3R9IGV2ZW50IOS6i+S7tgogICAgICovCiAgICBoYW5kbGVDbGljayAodGFiLCBldmVudCkgewogICAgICAvLyDmib7liLDngrnlh7vnmoTpobXpnaLlnKggdGFnIOWIl+ihqOmHjOaYr+WTquS4qgogICAgICBjb25zdCBwYWdlID0gdGhpcy5vcGVuZWQuZmluZChwYWdlID0+IHBhZ2UuZnVsbFBhdGggPT09IHRhYi5uYW1lKQogICAgICBjb25zdCB7IG5hbWUsIHBhcmFtcywgcXVlcnkgfSA9IHBhZ2UKICAgICAgaWYgKHBhZ2UpIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZSwgcGFyYW1zLCBxdWVyeSB9KQogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOeCueWHuyB0YWIg5LiK55qE5Yig6Zmk5oyJ6ZKu6Kem5Y+R6L+Z6YeMCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdGFnTmFtZSB0YWIg5ZCN56ewCiAgICAgKi8KICAgIGhhbmRsZVRhYlJlbW92ZSAodGFnTmFtZSkgewogICAgICB0aGlzLmNsb3NlKHsgdGFnTmFtZSB9KQogICAgfQogIH0sCiAgbW91bnRlZCAoKSB7CiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kMi1tdWx0aXBsZS1wYWdlLXNvcnQgLmVsLXRhYnNfX25hdicpWzBdCiAgICBTb3J0YWJsZS5jcmVhdGUoZWwsIHsKICAgICAgb25FbmQ6IChldnQpID0+IHsKICAgICAgICBjb25zdCB7IG9sZEluZGV4LCBuZXdJbmRleCB9ID0gZXZ0CiAgICAgICAgdGhpcy5vcGVuZWRTb3J0KHsgb2xkSW5kZXgsIG5ld0luZGV4IH0pCiAgICAgIH0KICAgIH0pCiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/layout/header-aside/components/tabs","sourcesContent":["<template>\n  <div class=\"d2-multiple-page-control-group\" flex>\n    <div class=\"d2-multiple-page-control-content\" flex-box=\"1\">\n      <div class=\"d2-multiple-page-control-content-inner\">\n        <d2-contextmenu\n          :visible.sync=\"contextmenuFlag\"\n          :x=\"contentmenuX\"\n          :y=\"contentmenuY\">\n          <d2-contextmenu-list\n            :menulist=\"tagName === '/index' ? contextmenuListIndex : contextmenuList\"\n            @rowClick=\"contextmenuClick\"/>\n        </d2-contextmenu>\n        <el-tabs\n          class=\"d2-multiple-page-control d2-multiple-page-sort\"\n          :value=\"current\"\n          type=\"card\"\n          @tab-click=\"handleClick\"\n          @tab-remove=\"handleTabRemove\"\n          @contextmenu.native=\"handleContextmenu\">\n          <el-tab-pane\n            v-for=\"page in opened\"\n            :key=\"page.fullPath\"\n            :label=\"page.meta.title || '未命名'\"\n            :name=\"page.fullPath\"\n            :closable=\"isTabClosable(page)\"/>\n        </el-tabs>\n      </div>\n    </div>\n    <div class=\"d2-multiple-page-control-btn\" flex-box=\"0\">\n      <el-dropdown\n        size=\"default\"\n        split-button\n        @click=\"closeAll\"\n        @command=\"command => handleControlItemClick(command)\">\n        <d2-icon name=\"times-circle\"/>\n        <el-dropdown-menu slot=\"dropdown\">\n          <el-dropdown-item command=\"left\">\n            <d2-icon name=\"arrow-left\" class=\"d2-mr-10\"/>\n            关闭左侧\n          </el-dropdown-item>\n          <el-dropdown-item command=\"right\">\n            <d2-icon name=\"arrow-right\" class=\"d2-mr-10\"/>\n            关闭右侧\n          </el-dropdown-item>\n          <el-dropdown-item command=\"other\">\n            <d2-icon name=\"times\" class=\"d2-mr-10\"/>\n            关闭其它\n          </el-dropdown-item>\n          <el-dropdown-item command=\"all\">\n            <d2-icon name=\"times-circle\" class=\"d2-mr-10\"/>\n            全部关闭\n          </el-dropdown-item>\n        </el-dropdown-menu>\n      </el-dropdown>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport Sortable from 'sortablejs'\n\nexport default {\n  components: {\n    D2Contextmenu: () => import('../contextmenu'),\n    D2ContextmenuList: () => import('../contextmenu/components/contentmenuList')\n  },\n  data () {\n    return {\n      contextmenuFlag: false,\n      contentmenuX: 0,\n      contentmenuY: 0,\n      contextmenuListIndex: [\n        { icon: 'times-circle', title: '关闭全部', value: 'all' }\n      ],\n      contextmenuList: [\n        { icon: 'arrow-left', title: '关闭左侧', value: 'left' },\n        { icon: 'arrow-right', title: '关闭右侧', value: 'right' },\n        { icon: 'times', title: '关闭其它', value: 'other' },\n        { icon: 'times-circle', title: '关闭全部', value: 'all' }\n      ],\n      tagName: '/index'\n    }\n  },\n  computed: {\n    ...mapState('d2admin/page', [\n      'opened',\n      'current'\n    ])\n  },\n  methods: {\n    ...mapActions('d2admin/page', [\n      'close',\n      'closeLeft',\n      'closeRight',\n      'closeOther',\n      'closeAll',\n      'openedSort'\n    ]),\n    /**\n     * @description 计算某个标签页是否可关闭\n     * @param {Object} page 其中一个标签页\n     */\n    isTabClosable (page) {\n      return page.name !== 'index'\n    },\n    /**\n     * @description 右键菜单功能点击\n     * @param {Object} event 事件\n     */\n    handleContextmenu (event) {\n      let target = event.target\n      // fix https://github.com/d2-projects/d2-admin/issues/54\n      let flag = false\n      if (target.className.indexOf('el-tabs__item') > -1) flag = true\n      else if (target.parentNode.className.indexOf('el-tabs__item') > -1) {\n        target = target.parentNode\n        flag = true\n      }\n      if (flag) {\n        event.preventDefault()\n        event.stopPropagation()\n        this.contentmenuX = event.clientX\n        this.contentmenuY = event.clientY\n        this.tagName = target.getAttribute('aria-controls').slice(5)\n        this.contextmenuFlag = true\n      }\n    },\n    /**\n     * @description 右键菜单的 row-click 事件\n     * @param {String} command 事件类型\n     */\n    contextmenuClick (command) {\n      this.handleControlItemClick(command, this.tagName)\n    },\n    /**\n     * @description 接收点击关闭控制上选项的事件\n     * @param {String} command 事件类型\n     * @param {String} tagName tab 名称\n     */\n    handleControlItemClick (command, tagName = null) {\n      if (tagName) this.contextmenuFlag = false\n      const params = { pageSelect: tagName }\n      switch (command) {\n        case 'left': this.closeLeft(params); break\n        case 'right': this.closeRight(params); break\n        case 'other': this.closeOther(params); break\n        case 'all': this.closeAll(); break\n        default: this.$message.error('无效的操作'); break\n      }\n    },\n    /**\n     * @description 接收点击 tab 标签的事件\n     * @param {object} tab 标签\n     * @param {object} event 事件\n     */\n    handleClick (tab, event) {\n      // 找到点击的页面在 tag 列表里是哪个\n      const page = this.opened.find(page => page.fullPath === tab.name)\n      const { name, params, query } = page\n      if (page) this.$router.push({ name, params, query })\n    },\n    /**\n     * @description 点击 tab 上的删除按钮触发这里\n     * @param {String} tagName tab 名称\n     */\n    handleTabRemove (tagName) {\n      this.close({ tagName })\n    }\n  },\n  mounted () {\n    const el = document.querySelectorAll('.d2-multiple-page-sort .el-tabs__nav')[0]\n    Sortable.create(el, {\n      onEnd: (evt) => {\n        const { oldIndex, newIndex } = evt\n        this.openedSort({ oldIndex, newIndex })\n      }\n    })\n  }\n}\n</script>\n"]}]}